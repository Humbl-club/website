{% assign colors = '' %}
{%- assign ntitle = '' -%}
{% assign position_of_color = 0 %}
{% for option in product.options_with_values %}
  {% if option.name == 'Color' %}
    {%- assign position_of_color = option.position | minus: 1 -%}
    {%- for value in option.values -%}
      {% assign colors = colors | append: ',' | append: value | append: ',' %}
    {% endfor %}
  {% endif %}
{% endfor %}
{% if colors != '' %}
  {% for variant in product.variants %}
    {% assign ntitle_array = variant.title | split: '/ ' %}
    {% assign ntitle = ntitle_array[position_of_color] | strip %}
    {% assign ntitle = ',' | append: ntitle | append: ',' %}
    {% if colors contains ntitle %}
      {%- assign ntitle = ntitle | remove: ',' -%}
    {% endif %}
  {% endfor %}
{% endif %}
{% for collection in product.collections %}
  {% if collection.title != 'All colors' %}
    {% if collection.title != '' %}
      {{ collection.title | append: ' | ' -}}
    {% endif %}
    {% if product.type != '' %}
      {{- product.type | append: ' | ' }}
    {% endif %}
    {% if ntitle != '' %}
      {{- ntitle | append: ' | ' -}}
    {% endif %}
    {% break %}
  {% endif %}
{% endfor %}

{%- assign ntitle = '' -%}
{%- assign colors = '' -%}
