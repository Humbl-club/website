{% if section.settings.video or section.settings.video_mobile %}
  {% assign poster = section.settings.image | image_url: width: 1920 %}
  {{
    section.settings.video
    | video_tag:
      autoplay: true,
      loop: true,
      muted: true,
      controls: false,
      image_size: '1920x',
      poster: poster,
      class: 'video-desctop'
  }}

  {% assign poster_mobile = section.settings.image | image_url: width: 600 %}
  {{
    section.settings.video_mobile
    | video_tag:
      autoplay: true,
      loop: true,
      muted: true,
      controls: false,
      image_size: '600x',
      poster: poster_mobile,
      class: 'video-mobile'
  }}
{% endif %}

{% if section.settings.image != blank %}
  <picture
    {% if section.settings.video == blank or section.settings.video_mobile == blank %}
      class="{% if section.settings.video != blank %} img-mobile {%elsif section.settings.video_mobile != blank %} img-desctop {% endif %}"
    {% endif %}
  >
    {% if section.settings.image_mobile != blank %}
      <source media="(max-width: 500px)" srcset="{{ section.settings.image_mobile | image_url: width: 1000 }}">
    {% endif %}
    {{
      section.settings.image
      | image_url: width: 1920
      | image_tag:
        loading: 'eager',
        width: section.settings.image.width,
        height: section.settings.image.height,
        widths: '1100, 1500, 1780, 1920, 2000, 3000, 3840',
        alt: section.settings.image.alt,
        fetchpriority: 'high'
      | escape
    }}
  </picture>
{% endif %}

{% schema %}
{
  "name": "Main section",
  "tag": "section",
  "class": "main img-cover",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "Mobile image"
    },
    {
      "type": "video",
      "id": "video",
      "label": "t:sections.video.settings.video.label"
    },
    {
      "type": "video",
      "id": "video_mobile",
      "label": "Mobile video"
    }
  ]
}
{% endschema %}
